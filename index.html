<!doctype html>
<html>
    <head>
        <link rel="stylesheet" href="node_modules/reveal.js/css/reveal.css">
        <link rel="stylesheet" href="node_modules/reveal.js/css/theme/white.css">
        <link rel="stylesheet" href="css/zenburn.css">
        <link rel="stylesheet" href="css/style.css">
        <title>AngularJs</title>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">

                <section data-markdown data-background-color="#0084ff">
                  <script type="text/template">
                    # Sviluppo di applicazioni web client: AngularJs

                    **Vincenzo Milone** @_vik
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ## Programma del corso
                    
                    * Perché Angular?
                    * Presentazione AngularJs <!-- .element: class="fragment" -->
                    * L'universo delle Web application <!-- .element: class="fragment" -->
                    * UI Router <!-- .element: class="fragment" -->
                    * Struttura dei sorgenti <!-- .element: class="fragment" -->
                    * Applicazione(i) d'esempio <!-- .element: class="fragment" -->
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Premesse

                  Alucune punti che è necessario conoscere:
                  * Perché sviluppare una web app nel 2017?
                  * Che differenza c'è fra una web app server-side e client-side?
                  
                  <small>In caso contrario, chiedete ;)</small>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ## AngularJs
                  
                    <img data-src="images/AngularJS-large.png" style="max-width: 350px">
                  
                    > AngularJS (o semplicemente Angular o Angular.js) è un framework web open source principalmente sviluppato da Google e dalla comunità di sviluppatori individuali che ruotano intorno al framework nato per affrontare le molte difficoltà incontrate nello sviluppo di applicazioni singola pagina.
                    
                    <small>Wikipedia</small>
                  </script>
                </section>

                <section data-markdown data-background-color="#0084ff">
                  <script type="text/template">
                    # Capitolo I
                    ## Le primitive AngularJs
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ## Le primitive AngularJs

                    Le primitive AngularJs sono attributi da assegnare
                    ai nostri elementi HTML per integrare le funzionalità
                    di Angular

                    <pre><code data-noescape>
                      &lt;div <mark>class="classe-css"</mark>&gt;...&lt;div&gt;
                      &lt;img <mark>src="url-immagine"</mark>&gt;
                    </code></pre>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ng-app e ng-controller

                    `ng-app` indica al sistema il nome dell'applicazione AngularJs da eseguire

                    ```html
                    <body ng-app="myApp">
                      <div ng-controller="myController as _my">
                        <p>{{ _my.hi }}</p>
                      </div>
                    </body>
                    ```
                   
                    <a href="https://codepen.io/_vik/pen/OpMLqx" class="btn" target="_blank">Play</a>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ng-model e ng-bind

                    ```html
                    <body ng-app="myApp">
                      <div ng-controller="myController as _my">
                        <input type="text" ng-model="_my.hi">
                        <p ng-bind="_my.hi"></p>
                      </div>
                    </body>
                    ```
                   
                    <a href="https://codepen.io/_vik/pen/dvGyGO" class="btn" target="_blank">Play</a>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ng-click

                    ```html
                    <body ng-app="myApp">
                      <div ng-controller="myController as _my">
                        <input type="text" ng-model="_my.hi">
                        <p ng-bind="_my.hi"></p>
                        <button ng-click="_my.hi = 'buongiorno'">Buongiorno</button>
                        <button ng-click="_my.reset()">Reset</button>
                      </div>
                    </body>
                    ```
                   
                    <a href="https://codepen.io/_vik/pen/Vpewjp" class="btn" target="_blank">Play</a>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ng-repeat

                    ```html
                    <body ng-app="myApp">
                      <div ng-controller="myController as _my">
                        <ul>
                          <li ng-repeat="user in _my.users track by $index">
                            {{ user.firstName }}
                            <a ng-click="_my.deleteUser($index, user)">&times;</a>
                          </li> 
                        </ul>
                      </div>
                    </body>
                    ```

                    <div class="fragment" style="font-size: 0.5em">
                    **Fondamentale**: sempre fornire un 
                    `track by` perché migliora le
                    prestazioni di ng-repeat. Può essere $index
                    (indice dell'array) o una proprietà degli
                    elementi, come id. Nel secondo caso dobbiamo
                    assicurarci che non ci siano duplicati nell'array
                    </div>
                   
                    <a href="https://codepen.io/_vik/pen/YZwzYr" class="btn fragment" target="_blank">Play</a>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ng-show e ng-hide

                    <small>Vogliamo nascondere gli utenti che hanno cognome troppo corto, meno di 4 lettere</small>

                    ```html
                    <body ng-app="myApp">
                      <div ng-controller="myController as _my">
                        <ul>
                          <li 
                            ng-repeat="user in _my.users track by $index" 
                            ng-hide="user.lastName.length < 4"
                          >
                            {{ user.firstName }}
                          </li> 
                        </ul>
                      </div>
                    </body>
                    ```

                    <div class="fragment" style="font-size: 0.5em">
                    **Attenzione**: l'elemento viene mostrato/nascosto via CSS `display: none !important`
                    </div>
                   
                    <a href="https://codepen.io/_vik/pen/zZrYmK" class="btn fragment" target="_blank">Play</a>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ng-if

                    <small>Riprendiamo l'esempio precedente. Se il controllo è "falso", l'emento non sarà visibile nell'HTML (nel codice vedremo solo una riga commentata)</small>

                    ```html
                    <body ng-app="myApp">
                      <div ng-controller="myController as _my">
                        <ul>
                          <li 
                            ng-repeat="user in _my.users track by $index" 
                            ng-if="user.lastName.length > 3"
                          >
                            {{ user.firstName }}
                          </li> 
                        </ul>
                      </div>
                    </body>
                    ```

                  </script>
                </section>
                
                <section data-markdown>
                  <script type="text/template">
                    ng-switch (1/2)

                    Se i nostri utenti hanno un ruolo, vogliamo stampare: 
                    * in grassetto gli utenti "ADMIN"
                    * in corsivo i "DEVELOPER"
                    * normale tutti gli altri
                    

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ng-switch (2/2)

                    ```html
                    <body ng-app="myApp">
                      <div ng-controller="myController as _my">
                        <ul>
                          <li 
                            ng-repeat="user in _my.users track by $index" 
                            ng-switch="user.role"
                          >
                            <strong ng-switch-when="ADMIN">
                              {{ user.firstName }} (amministratore)
                            </strong>
                            <em ng-switch-when="DEVELOPER">
                              {{ user.firstName }} (sviluppatore)
                            </em>
                            <span ng-switch-default>
                              {{ user.firstName }}
                            </span>
                          </li> 
                        </ul>
                      </div>
                    </body>
                    ```

                    <small class="fragment">Per funzionare un elemento `ng-switch-default` è necessario
                    <a href="https://codepen.io/_vik/pen/jBWEGq" class="btn fragment" target="_blank">Play</a>
                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                    ng-required
                  
                    <img data-src="images/form_ng-required.png">
                  
                    Vogliamo che il campo "P. IVA" sia *required* solo se la checkbox è selezionata
                    <a href="https://codepen.io/_vik/pen/MpeZEW" class="btn fragment" target="_blank">Play</a>

                    <small class="fragment">Dare sempre feedback agli utenti: rendiamo evidenti i campi che sono (o diventano) obbligatori</small>

                  </script>
                </section>
                
                
                <section data-markdown>
                  <script type="text/template">
                    ng-disabled

                    Riprendiamo l'esempio precedente: non vogliamo che l'utente possa inviare la form finché non compila il campo "Nome e cognome"

                    ```html
                    ...
                    <button 
                      ng-disabled="!_my.user.fullName" 
                      type="submit" 
                      class="btn btn-primary"
                    >
                      Invia
                    </button>
                    ```
                    
                    <a href="https://codepen.io/_vik/pen/LWZMvO" class="btn fragment" target="_blank">Play</a>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    ng-submit

                    Permette di eseguire una funzione quando la form viene *inviata* (submitted)

                    ```html
                    <form 
                      ng-submit="_my.submit()"
                      class="form-horizontal"
                    >
                      ...
                    </form>
                    ```

                    [Play](https://codepen.io/_vik/pen/mWEaZz) <!-- .element: class="btn fragment" target="_blank" -->
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ng-options (1/3)

                  Si utilizza nelle `<select>` per valizzare i campi `<option>`
                  
                  Permette di valorizzare sia l'attributo `value` che la *label* mostrata all'utente
                  ```html
                  <select>
                    <option value="1">Descrizione 1</option>
                    <option value="2">Descrizione 2</option>
                    ...
                  </select>
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ng-options (2/3)

                  Prendiamo un `array` contenente i possibili ruoli da assegnare ad un utente
                  
                  ```javascript
                      this.userRoles = [
                        {
                          'id': 'ADMIN',
                          'description': 'Amministratore' 
                        },
                        {
                          'id': 'DEVELOPER',
                          'description': 'Sviluppatore' 
                        },
                        {
                          'id': 'BASE',
                          'description': 'Altro' 
                        }
                      ]
                          
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ng-options (3/3)

                  ```html
                  <select 
                    ng-model="_my.user.role"
                    ng-options="role.id as role.description for role in _my.userRoles"
                  >
                    <option value="">Seleziona ruolo</option>
                  </select>
                  <p ng-bind="_my.user.role"></p>
                  ```
                  
                  NB: <!-- .element class="fragment small" -->

                  <ul class="small">
                    <li class="fragment">nella variabile associata a `ng-model` verrà salvato l'id</li>
                    <li class="fragment">un'opzione vuota `<option value=""></option>` è sempre necessaria
                  </ul>

                  [Play](https://codepen.io/_vik/pen/MpeLbJ) <!-- .element: class="btn fragment" target="_blank" -->
                  </div>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ng-change (1/2)

                  Permette di eseguire una funzione quando un dato campo di input cambia il proprio valore
                  a seguito di un'azione dell'utente. 

                  Di solito si utilizza per svolgere una logica quando l'utente seleziona
                  un valore di una `<select>`

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ng-change (2/2)

                  Esempio classico: abbiamo due select con Regione e Provincia, quando l'utente seleziona una certa Regione è necessario filtrare le Province <!-- .element: class="small" -->

                  ```html
                  <select
                    name="regione"
                    ng-model="_my.user.area"
                    ng-change="_my.updateProvinceList()"
                    ng-options="area.id as area.description for area in _my.areaList"
                  >
                    <option value="">Seleziona una regione</option>
                  </select>
                  <select
                    name="provincia"
                    ng-disabled="!_my.user.area"
                    ng-model="_my.user.province"
                    ng-options="province.id as province.description for province in _my.provinceList"
                  >
                    <option value="">Seleziona una provincia</option>
                  </select>
                  ```
                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                  ng-class (1/2)
                  
                  <small>Permette di aggiungere o rimuovere una o più classi CSS ad un elemento.</small>

                  <small>Esempio: vogliamo aggiungere una classe CSS `btn--active` a un bottone quando questo è attivo</small>
                  ```html
                  <label>Questo corso è interessante?</label>
                  <button
                    class="btn"
                    ng-click="_my.response = 'Si'"
                    ng-class="{'btn--active': _my.response === 'Si'}"
                  >
                    Si
                  </button>
                  <button
                      class="btn"
                      ng-click="_my.response = 'Assolutamente si'"
                      ng-class="{'btn--active': _my.response === 'Assolutamente si'}"
                    >
                      Assolutamente si
                  </button>
                  ```

                  [Play](https://codepen.io/_vik/pen/GWmYzy) <!-- .element: class="btn fragment" target="_blank" -->
                  </script>
                 </section>

                 <section data-markdown>
                  <script type="text/template">
                  ng-class (2/2)

                  <small>Esistono diversi modi di utilizzare `ng-class`</small>
                  
                  ```html
                  <!-- Oggetto -->
                  <button ng-class="{'btn--active': _my.isActive, 'btn--disabled': _.my.isDisabled}">
                    Bottone 1
                  </button>
                  <!-- Stringa -->
                  <article class="post" ng-class="{'post-id'+_my.post.id}">
                    ...
                  </article>
                  <!-- Funzione -->
                  <article ng-class="_my.getPostClasses(_my.post)">
                    ...
                  </article>
                  ```
                  </script>
                 </section>

                 <section data-markdown>
                  <script type="text/template">
                  ng-style (1/3)

                  Permette di assegnare stile `inline` a un elemento. 
                  
                  Utile, ad esempio, per creare uno slideshow di immagini

                  </script>
                 </section>

                 <section data-markdown>
                  <script type="text/template">
                  ng-style (2/3)

                  <small>Come si relizza un semplice slideshow:</small>

                  <img data-src="/images/slideshow-preparazione.jpg" class="fragment" style="max-width: 420px">

                  <img data-src="/images/slideshow-slide-spostata.jpg" class="fragment" style="max-width: 420px">

                  </script>
                 </section>

                  <section data-markdown>
                    <script type="text/template">
                    ng-style (3/3)

                    ```html
                    <div class="slideshow">
                      <div class="slides" ng-style="_my.slideshowStyle">
                        <div class="slide" ng-repeat="image in _my.images track by $index">
                          <img ng-src="{{image}}" alt="">
                    ```

                    [Play](https://codepen.io/_vik/pen/jBmQbo) <!-- .element class="btn fragment" target="_blank" -->

                    </script>
                  </section>

                 <section data-markdown data-background-color="#0084ff">
                  <script type="text/template">
                    # Capitolo II
                    ## La struttura di un'applicazione AngularJs
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                    Un'applicazione AngularJs è divisa in:
                    * module <!-- .element class="fragment" -->
                    * contoller <!-- .element class="fragment" -->
                    * service <!-- .element class="fragment" -->
                    * factory <!-- .element class="fragment" -->
                    * directive <!-- .element class="fragment" -->
                    * constant <!-- .element class="fragment" -->
                    * ... <!-- .element class="fragment" -->
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `module` (1/3)

                  Dalla documentazione ufficile AngularJs:

                  Si può vedere un modulo come un contenitore di diverse parti dell'applicazione: controller, service, direttive, ... <!-- .element class="small fragment" -->

                  La maggior parte delle applicazioni hanno un metodo principale (main) che mette insieme le diverse parti dell'app. <!-- .element class="small fragment" -->

                  AngularJS non ha un metodo principale. Invece è la dichiarazione dei moduli a specificare come l'app dovrebbe esseere eseguita. <!-- .element class="small fragment" -->

                  Questo approccio ha diversi vantaggi. Il principale è che puoi creare moduli indipendenti e riusabili. <!-- .element class="small fragment" -->


                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `module` (2/3)

                  In realtà abbiamo già visto come si dichiara un modulo

                  ```javascript
                  angular
                    .module('nomeModulo', [])
                  ```

                  Introduciamo il concetto di dipendenze:

                  ```javascript
                  angular
                    .module('nomeModulo', [
                      'ngAnimation',
                      'ngSanitize'
                    ])
                  ```

                  `ngAnimation`, `ngSanitize` e ngCookie sono **moduli** di AngularJs che userete *sempre* nelle vostre app.

                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                  `module` (3/3)

                  *Moduli riusabili*: immaginiamo di dover sviluppare un'app per la gestione di un blog.

                  <div class="small">
                  Possiamo dividere l'app in due moduli principali:
                  * gestione utenti, che chiameremo `ngUsers`
                  * gestione posts, `ngPosts`
                  </div>
                  La dichiarazione della nostra app sarà:

                  ```javascript
                  angular
                    .module('ngUsers', [])
                    .module('ngPosts', [])
                    .module('ngBlog', [
                      'ngAnimation',
                      'ngSanitize',
                      'ngUsers',
                      'ngPosts'
                    ])
                  ```

                  Note:
                  .module('ngUsers', []) e .module('ngUsers') hanno due significati *molto* diversi

                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                  `controller`

                  In angular un controller è una funzione javascript contenente la **business logic** dell'app.

                  Un controller appartiene a un modulo:

                  ```javascript
                  angular
                    .module('ngUsers')
                    .controller('UsersController', UsersController);
                  
                  function UsersController() {
                    /* Logica di business */
                  }
                  ```

                  </script>
                 </section>
                
                <section data-markdown>
                  <script type="text/template">
                  `service` (1/2)

                  Una `service` è un'oggetto javascript che viene instanziato come `singleton`
                  e utilizzato in uno o più controller

                  Solitamente vengono utilizzati per operazioni come:
                  * estrarre i dati da una fonte
                  * effettuare una chiamata una webservice e restituire il dato

                  </script>
                 </section>

                <section data-markdown>
                  <script type="text/template">
                  `service` (2/2)

                  Anche le service appartengono a un modulo

                  ```javascript
                  angular
                    .module('ngUsers', [])
                    .service('UsersModel', UsersModel);
                  
                  function UsersModel() {
                    this.getUsers = function() {
                      /* Restituisce tutti o parte gli utenti */
                    }
                    this.getUser = function(userId) {
                      /* Restituire un singolo utente */
                    }
                  }
                  ```
                  
                  Quindi, nel nostro controller:
                  
                  ```javascript
                  function UsersController(UsersModel) {
                    this.users = UsersModel.getUsers();
                  }
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `factory`

                  Anche se una `service` e una `factory` sono diverse a livello
                  tecnico, all'atto pratico hanno lo stesso comportamento.

                  ```javascript
                  angular
                    .module('ngUsers')
                    .factory('UsersFactory', UsersFactory);
                  
                  function UsersFactory() {
                    function getUsers() {
                      /* Restituisce tutti o parte gli utenti */
                    }
                    function getUser(userId) {
                      /* Restituire un singolo utente */
                    }
                    return {
                      'getUsers': getUsers,
                      'getUser': getUser
                    }
                  }
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `directive` (1/6)

                  Si tratta di un **nodo chiave** dell'approccio AngularJs allo sviluppo di applicazioni web.

                  Per capire di cosa si tratti, vediamo subito come si dichiara una direttiva:

                  ```javascript
                  angular
                    .module('ngUsers')
                    .directive('UsersList', UsersListDirective);

                  function UsersListDirective() {
                    return {
                      restrict: 'E',
                      templateUrl: 'users/list.html',
                      controller: 'UsersController',
                      controllerAs: '_users'
                    }
                  }
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `directive` (2/6)

                  Da qualche parte nel nostro codice html
                  
                  ```html
                    <section class="section--user-list">
                      <users-list></users-list>
                    </section>
                  ```

                  Dentro `<users-list>` verrà appeso il contenuto del template presente in `users/list.html`
                  
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `directive` (3/6)

                  Vediamo nel dettalgio:
                  <ul class="small">
                    <li class="fragment">`restrict` è una stringa che indica ad AngularJs se la nostra direttiva è un elemento HTML o un attributo</li>
                      <ul>
                        <li class="fragment">'E' --> elemento `<users-list></user-list>`</li>
                        <li class="fragment">'A' --> attributo `<div user-list></div>`</li>
                        <li class="fragment">'AE' --> entrambi, *sconsigliato*</li>
                      </ul>
                    <li class="fragment">`templateUrl` indica ad AngularJs dove trovare il template della direttiva</li>
                    <li class="fragment">
                      `template`, alternativa a `templateUrl`, permette di dichiarare il template come stringa (consigliato *solo* per direttive molto semplici)
                      
                      <pre><code>
                      template: '<ul><li ng-repeat="user in _users.users track by $index">...</li></ul>'
                      </code></pre>
                    
                    </li>
                    <li class="fragment">`controller`, il controller associato alla direttiva</li>
                    <li class="fragment">`controllerAs`, il mome con cui riferire il controller nel template</li>
                  </ul>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `directive` (4/6)

                  Perché sono così importanti le direttive?

                  <ol>
                    <li class="fragment">Permettono di scrivere codice *estremante* riusabilie.</li>
                    <li class="fragment">Facilitano un'approccio "divide et impera", dove ogni direttiva ha una responsabilità limitata.</li>
                  </ol>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `directive` (5/6)

                  <small>Riprendiamo l'esmpio di `<users-list>`. Questo è il template:</small>
                  
                  ```html
                  <ul class="users-list">
                    <li
                      ng-repeat="user in _users.users track by $index"
                      users-list-item
                    >
                    </li>
                  </ul>
                  ```

                  <small>Dove la nuova direttiva `userListItem` si occuperà di stampare i dati un singolo utente.</small>

                  <p class="fragment">Ma come fa la `userListItem` a sapere *quale* utente rappresentare della lista?</p>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `directive` (6/6)

                  <small>Possiamo passare un dato alla direttiva con `bindToController`</small>

                  ```html
                  <li ng-repeat="user in _users.users track by $index"
                      users-list-item
                      user-model="user"
                  >
                  ```

                  ```javascript
                    angular
                      .module('ngUsers')
                      .directive('usersListItem', usersListItemDirective);

                    function usersListItem() {
                      return {
                        restrict: 'A',
                        template: '<span class="user-list-item">{{_user.userModel.firstName}} {{_user.userModel.lastName}}</span>'
                        controller: 'UserController',
                        controllerAs: '_user',
                        bindToController: {
                          userModel: '@'
                        }
                      }
                    }
                  ```

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `constant`

                  Permette di definire delle constanti, siano esse stringe, numeri o oggetti.
                  ```javascript
                  angular
                    .module('ngUsers')
                    .constant('apiKey', 'a12mdks93skjk22')
                    .constant('userRoles', {
                      ADMIN: 'Administrator',
                      DEV: 'Developer',
                      BASE: 'Base'
                    });
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$inject`

                  Si tratta di una funzionalità di AngularJs che permette di "passare" a un funzione, es un `controller` le sude dipendnenze

                  ```javascript
                  angular
                    .module('ngUsers', [])
                    .constant('userRoles', {
                      ADMIN: 'Amministatore',
                      DEV: 'Sviluppatore'
                    })
                    .controller('UsersController', ['userRoles', UsersController]);
                  
                  function UsersController(userRoles)  {
                    this.userRoles = userRoles;
                  }
                  ```
                  
                  </script>
                </section>
                
                <section data-markdown>
                  <script type="text/template">
                  `$scope` (1/5)

                  Lo `$scope` è il *cuore pulsante* di AngularJs

                  Funziona da ponte fra la logica applicativa (controller, etc)
                  e la vista (DOM)
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$scope` (2/5)

                  ```javascript
                  .controller('HiController', ['$scope', HiController])
                  function HiController($scope) {
                    $scope.hi = 'Ciao ciao';
                    $scope.aFunction = function() {...}
                  }
                  ```

                  ```html
                  <div ng-controller="HiController">
                    <p>{{ hi }}</p>
                    <a ng-click="aFunction()">Click here</a>
                  </div>
                  ```

                  <small class="fragment">Come mai fin ora non si è mai utilizzato?</small>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$scope` (3/5)

                  Lo `$scope` è gerarchico.

                  ```html
                  <!-- Nello $scope abbiamo una variabile users -->
                  <ul class="user-list">
                    <li ng-repeat="user in users track by $index">
                      <!-- Nello $scope abbiamo una variabile user -->
                      {{ user.firstName }} {{ user.lastName }}
                      <!-- ma, abbiamo visibilità anche di users! -->
                    </li>
                  </ul>
                  ```

                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                  Fare grafico sulle gerarchia dello $scope
                  </script>
                </section>

                
                <section data-markdown>
                  <script type="text/template">
                  `$watch` (1/3)

                  Lo `$scope` ci offre potenti strumenti, il primo fra tutti è
                  `$scope.$watch()`, che ci permette di eseguire una funzione
                  quando una variabile "osservata" cambia il suo valore.

                  <pre class="fragment"><code class="javascript">
                  $scope.users = [...]
                  $scope.doSomething = function(users) {...}
                  $scope.$watch('users', function(newValue, oldValue) {
                    //Il nuovo valore si trova in newValue
                    doSomething(newValue);
                  })                    
                  </code></pre>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$watch` (2/3)

                  Ci permette anche di "osservare" il risultato
                  di una funzione.

                  <pre class="fragment"><code class="javascript">
                  $scope.users = [...]
                  $scope.$watch(function() {
                    return $scope.users.length;
                  }, function(newValue, oldValue) {
                    // La lunghezza di user è cambiata!
                  })                    
                  </code></pre>

                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                  `$watch` (3/3)

                  E persino oggetti complessi.

                  <pre class="fragment"><code class="javascript">
                  $scope.user = {
                    firstName: 'Vincenzo',
                    lastName: 'Milone'
                  }
                  $scope.$watch('user', function(newValue, oldValue) {
                    // Una proprietà di user è cambiata!
                  }, true);                    
                  </code></pre>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Eventi `$scope`

                  Grazie alla sua struttura gerarirca, è possibile sollevare
                  e catturare eventi esattamente come accade nel DOM.

                  <pre class="fragment"><code class="javascript">
                  // nomeEvento1 verrà inviato verso i figli, fino alle foglie
                  $scope.$emit('nomeEvento1', dati);
                  
                  // nomeEvento2 verrà inviato verso i padri, fino alla radice
                  $scope.$emit('nomeEvento2', dati);

                  // cattura l'evento nomeEvento3 con i dati allegati
                  $scope.$on('nomeEvento3', function($event, dati) {
                    ...
                  });
                  </code></pre>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Perché *non* usare lo `$scope` (1/4)

                  Negli esempi fatti fin ora ho sempre evitato di usare lo `$scope`
                  preferendo il `this` all'interno del controller.

                  Vediamo perché.

                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                  Perché *non* usare lo `$scope` (2/4)

                  ```javascript
                  angular
                    .module('myApp', [])
                    .controller('firstController', ['$scope', firstController])
                    .controller('secondController', ['$scope', secondController])

                  function firstController($scope) {
                      $scope.myVar = 10;
                  }

                  function secondController($scope) {
                      $scope.myVar = $scope.myVar + 10;
                  }
                  ```

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Perché *non* usare lo `$scope` (3/4)

                  ```html
                  <div ng-controller="firstController">
                    <div ng-controller="secondController">
                      <p>{{ myVar }}</p>
                    </div>
                  </div>
                  
                  <div ng-controller="secondController">
                    <p>{{ myVar }}</p>
                  </div>
                  ```
                  
                  [Cosa verrà stampato?](https://codepen.io/_vik/pen/NpgeKK) <!-- .element class="btn fragment" target="_blank" -->

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Perché *non* usare lo `$scope` (4/4)

                  Usare il `controllerAs` anziché direttamente lo `$scope`
                  evita situazioni ambigue, e facilita la separazione delle
                  responsabilità fra componenti.

                  Questo approccio diventa un **must** in applicazioni complesse e di
                  grandi dimensioni.

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$element`

                  <small>`$element` rappresenta l'oggetto DOM a cui è "attaccato"
                  il controller o la direttiva in esecuzine.</small>

                  <small>In realtà è un oggetto **jqLite**, che ci fornisce alcune funzioni
                  come addClass(), append(), etc...</small>

                  ```javascript
                  .controller('myController', ['$element', myController]);

                  function myController($element) {
                    $element.addClass('my-css-class');
                  }
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$filter` (1/3)

                  Permette di applicare un **filtro** a una variabile.

                  Un filtro è una funzione di *trasformarzione* dati.

                  ```
                  <!-- Nel controller -->
                  $scope.filtered = $filter('nomeFiltro')(varibileDaFiltrare)
                  <!-- Direttamente nella vista -->
                  <p ng-bind="varibileDaFiltrare | nomeFiltro"></p>
                  ```

                  <div class="fragment">
                    I filtri sono facilmente concatenabili
                    
                    <pre><code>
                    <p ng-bind="varibileDaFiltrare | nomeFiltro1 | nomeFiltro2 | ..."></p>
                    </code></pre>
                  </div>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$filter` (2/3)

                  Un tipico esempio di filtro è un campo di ricerca
                  che *filtra* (scusate il gioco di parole) una serie di risultati.

                  Torniamo al nostro esempio degli utenti:
                  
                  [Play](https://codepen.io/_vik/pen/XMgoYZ) <!-- .element class="btn" target="_blank" -->
                  </script>
                 </section>

                <section data-markdown>
                  <script type="text/template">
                  `$filter` (3/3)

                  Oppure possiamo scrivere un nostro filtro:

                  ```javascript
                  .filter('alQuadrato', function() {
                    return function(input) {
                      return input*input;
                    }
                  });
                  ```

                  [Play](https://codepen.io/_vik/pen/YZQdJb) <!-- .element class="btn" target="_blank" -->

                  </script>
                 </section>

                <section data-markdown>
                  <script type="text/template">
                  `$q` (1/2)

                  `$q` ci permette di eseguire funzioni in modo *asincrono* e di utilizzare
                  il valore restituito da queste funzioni **solo quando** l'esecuzione è terminata.

                  <p class="fragment">`$q` restituisce una **promessa**, un oggetto che verrà:</p>
                  <ul>
                    <li class="fragment">**risolto** quando la funzione asincrona avrà finito la sua esecuzione,</li>
                    <li class="fragment">**rifiutato** quando la funzione asincrona verrà terminata con un errore.</li>
                  </ul>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$q` (2/2)

                  Un oggetto `promise` espone una funzione `then` che viene automaticamente
                  sollevata quando la promessa viane risolta o rifiutata.

                  ```javascript
                  function asincrona() {
                    var d = $q.deferr();
                    try {
                      //Fai qualcosa di asincrono o un timeout
                      ...
                      d.resolve(dati);
                    } catch(e) {
                      //Oh no, c'è stato un errore
                      d.reject(e);
                    }
                    return d.promise;
                  }

                  var promise = asincrona();
                  promise.then(
                    function(dati) {
                      //La promessa è stata risolta, possiamo usare dati
                      $scope.myVar = dati;
                    },
                    function(error) {
                      //La promessa è stata rifiutata, gestiamo l'errore
                    }
                  )
                  ```

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$http`

                  <small>Un tipico uso di `promise` è rappresentato nelle chiamate AJAX,
                  che in AngularJs si effettuano con la service `$http`.</small>

                  <small>`$http` permette di effettuare una chiamata GET, POST, etc e 
                  restituisce una promessa legata alla chiamata stessa.</small>

                  
                  <pre class="fragment">
                  <code>function getUsers() {
                    return $http.get('/api/v1/users');
                  }
                  </code></pre>

                  <pre class="fragment">
                  <code>UsersModel.getUsers().then(function(response) {
                    //L'ogetto response rappresenta la risposta del server
                    $scope.users = response.body.users;
                  }, function(error) {
                    //La chiamata è stata rifiutata, ad esempio un tiemout 
                    //della chiamata HTTP
                  })
                  </code></pre>

                  </script>
                </section>

                <section data-markdown data-background-color="#0084ff">
                  <script type="text/template">
                    # Capitolo III
                    
                    ## L'universo delle Web application
                    
                    Una breve introduzione
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Quello dello sviluppo di "Web application" è un universo, all'interno del
                  quale AngularJs è solo un tassello.
                  <div class="fragment">
                    ![Stack](/images/stack.jpg)

                    <small>Fonte: https://www.linkedin.com/pulse/fintech-recipes-tech-concoction-mbas-jds-amilcar-chavarria</small>
                  </div>
                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                  ## CSS pre-processor

                  <small>`sass` e `less` sono due CSS **pre-processor** che permettono di scrivere CSS in maniera più conincisa, riusabile e *leggibile*</small>

                  <pre class="fragment">
                  <code class="scss">@mixin full-background($background) {
                    background-image: url($background);
                    background-position: 50% 50%;
                    background-size: cover;
                    background-repeat: no-repeat;
                  }
                  $title-size: 24px;

                  .hero {
                    @include full-background('/img/background-image.jpg');
                    .hero__title {
                      font-size: $title-size;
                    }
                  }
                  </code></pre>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Risultato CSS
                  
                  ```css
                  .hero {
                    background-image: url("/img/background-image.jpg");
                    background-position: 50% 50%;
                    background-size: cover;
                    background-repeat: no-repeat;
                  }
                  .hero .hero__title {
                    font-size: 24px;
                  }
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Versionamento del codice

                  Per introdurre `git` ci vorrebbe un workshop a parte. 

                  In breve, `git` è la risposta alle seguenti domande:

                  * Come gestisco il codice se due o più persone devono lavorare sugli stessi file? <!-- .element class="fragment small" -->
                  * Come tengo traccia delle modifiche fatte fin ora? <!-- .element class="fragment small" -->
                  * Come differenzio il codice presente nell'ambiente di test (nuovi sviluppi) da quello di produzione (stabile e testato)? <!-- .element class="fragment small" -->
                  
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Gestione pacchetti

                  Vogliamo aggiungere l'ultima versione di AngularJs al nostro progetto:
                  * andiamo su https://angularjs.org
                  * scarichiamo l'ultima versione
                  * aggiungiamo il file scaricato alla cartella `scripts`
                  * includiamo lo script <small><code>&lt;script src="scripts/angular.min.js"&gt;&lt;/script&gt;</code></small>

                  <p class="fragment" style="color: #cc0000; font-size: 4rem; text-align: center">Sbagliato!!!</p>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `npm` e `bower`

                  <small>Si tratta di due *package manager* che ci permettono di aggiungere/rimuovere componenti
                  al nostro progetto senza preoccuparci troppo della versione e della provenienza.</small>

                  Per installare AngularJs è sufficiente:
                  ```
                  bower install angular --save
                  ```

                  Quando passerete il progetto a un collega (`git`), gli basterà
                  ```
                  bower install
                  ```
                  per installare tutti i pacchetti salvati.

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Le componenti bower indispensabili

                  Ci sono alcuni pacchetti di cui non potrete fare a meno nello 
                  sviluppo di applicativi Web.

                  Il primo fra tutti è `lodash`, il quale ci fornisce una serie 
                  di strumenti per la manipolazione di oggetti, array, etc ect

                  ```
                  bower install lodash --save
                  ```

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `lodash`

                  Giusto per darvi un'idea della comodità di `lodash`:
                  
                  ```javascript
                  /* Voglio rimuovere dalla lista degli utenti,
                  ** coloro che hanno ruolo di amministratore
                  */
                  _.remove($scope.users, function(user) {
                    return user.role === "ADMIN";
                  })
                  ```
                  
                  ```javascript
                  /* Voglio essere sicuro che nella lista degli utenti,
                  ** non ci siano duplicati 
                  */
                  $scope.users = _.uniq($scope.users);
                  ```
                  
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `moment`

                  Tralasciando la sfortunata scelta di *naming*, 
                  `moment` ci facilita nella gestione delle date, risolvendo problemi come il fuso orario e la localizzazione.
                  
                  ```
                  bower install moment --save
                  ```

                  ```javascript
                  moment.locale('it'); 
                  moment("2017-12-12").fromNow();
                  --> "tra 9 mesi"
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `angular-*`

                  AngularJs fornisce diversi pacchetti non inclusi nel *core* che sono
                  necessari in ogni web application

                  ```
                  bower install angular-sanitize angular-animate angular-touch --save
                  ```

                  <ul class="small">
                    <li class="fragment">`angular-sanitize` (ngSanitize), come esprime il nome del modulo sanitizza le stringhe che stampiamo nell'HTML, evitando problemi di sicurezza</li>
                    <li class="fragment">`angular-animate` (ngAnimate), permette di relizzare animazioni CSS legate ad eventi Angular</li>
                    <li class="fragment">`angular-touch` (ngTouch), migliora il supporto di dispositivi *touch-enabled* offrendo primitive come ng-swipe-left/ng-swipe-right</li>
                  </ul>
                  
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `ngBootstrap`

                  Si tratta di un modulo che implementa in AngularJs le funzionalità del famoso framework **Bootstrap**.
                  ```
                  bower install angular-bootstrap --save
                  ```

                  <div class="small">
                  <p>Ci offre una serie di utili direttive come</p>
                  <ul>
                    <li>`uib-accordion`</li>
                    <li>`uib-datepicker`</li>
                    <li>`uib-dropdown`</li>
                    <li>`uib-modal`</li>
                    <li>...</li>
                  </ul>
                  </div>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `gulp`

                  Si tratta di un *task runner*: uno strumento che esegue alcuni compiti che eseguiti a mano richiderebbe troppo tempo.

                  Un esempio è il task che converte automaticamente i file .LESS in file .CSS

                  ```javascript
                  gulp.task('less', function () {
                    return gulp.src('**/*.less')
                      .pipe(less())
                      .pipe(gulp.dest('./dist/css'));
                  });
                  ```

                  </script>
                </section>

                <section data-markdown data-background-color="#0084ff">
                  <script type="text/template">
                    # Capitolo IV
                    
                    ## UI Router
                    
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Routing

                  Il `routing` è un'approccio allo sviluppo di Web application per il quale è la URL a guidare il comportamento dell'applicazione.

                  <div class="fragment">
                  Ad esempio, i nei framework PHP la URL è così formata
                  `/nomeController/nomeFunzione`

                  <pre>
                  <code class="php">// URL -> /users/list
                  class Users extends Controller {
                    ...
                    public function list() {

                    }
                    ...
                  }
                  </code></pre>
                  </div>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## UI Router

                  Questo approccio è il più utilizzato nello sviluppo di applicazioni AngularJs. 

                  A tal proposito ci viene in aiuto il modulo UI Router 
                  ```
                  bower install angular-ui-router --save
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Stati

                  UI Router permette di associare a una URL, o meglio ad un path,
                  uno **stato**

                  Ogni stato è così definito: <!-- .element class="fragment" -->

                  <div class="fragment panel">
                    <header class="panel__header">Stato</header>
                    <div class="panel__body">
                      <ul>
                        <li>Nome</li>
                        <li class="fragment">URL</li>
                        <li class="fragment">Controller</li>
                        <li class="fragment">Controller as</li>
                        <li class="fragment">Template/TemplateUrl</li>
                      </ul>
                    </div>
                  </div>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$stateProvider`

                  `$stateProvider` è l'oggetto che UI Router ci fornisce per la gestione e definizione degli stati.

                  ```javascript
                  //Creazione stato "Home"
                  $stateProvider.state('home', {
                    url: '/home',
                    controller: 'HomeController',
                    controllerAs: 'home',
                    templateUrl: 'home.html'
                  })
                  ```

                  ```html
                  <!-- Nel nostro file index.html -->
                  <div ui-view></div>
                  ```

                  <small class="fragment">La direttiva `ui-view`, alla url <mark>/home</mark>, verrà sostituita da `home.html` gestita da HomeController</small>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Viste

                  <small>UI Router ci permette di associare a uno stato più *viste*, utile se vogliamo suddividere il nostro layout
                  in più parti, come "contenuto" e "sidebar"</small>
                  
                  <div style="display: table">
                    <div style="display: table-cell; width: 50%">
                      <pre class="fragment"><code class="html"><!-- index.html -->
                  <div class="layout">
                    <main ui-view="content"></main>
                    <aside ui-view="sidebar"></aside>
                  </div>
                      </code></pre>
                    </div>
                    <div style="display: table-cell; width: 50%">
                      <pre class="fragment"><code class="javascript">// app.js
                  $stateProvider.state('home', {
                    url: '/home',
                    views: {
                      'content': {
                        controller: 'HomeController',
                        controllerAs: 'home',
                        templateUrl: 'home.html'
                      },
                      'sidebar': {
                        templateUrl: 'sidebar.html'
                      }
                    }
                  })
                      </code></pre>
                    </div>
                  </div>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Gerarchia stati

                  UI Roter ci permette di create stati e sotto-stati.

                  **Esempio** vogliamo creare 2 stati:
                  1. lista utenti --> <mark>/users</mark>
                  2. dettaglio utente --> <mark>/users/detail</mark>
                  
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  1 Lista utenti /users

                  Prima registriamo lo stato **padre**
                  ```javascript
                  $stateProvider.state('users', {
                    url: '/users',
                    controller: 'UsersController',
                    controllerAs: '_users',
                    templateUrl: 'users.html'
                  })
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  2 Dettaglio utente /users/list

                  Quindi lo stato **figlio**
                  ```javascript
                  $stateProvider.state('users.detail', {
                    url: '/detail',
                    controller: 'UserController',
                    controllerAs: '_user',
                    templateUrl: 'user-detail.html'
                  })
                  ```

                  Alcune *note*:
                  * lo stato figlio si caratterizza dal **nome**, nella forma `nomePadre.nomeFiglio`
                  * la URL dello stato figlio si compone di quella del padre e della propria
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Parametri di stato

                  La url `/users/detail` non ci da alun indizio riguardo quale utente stiamo mostrando.

                  Sarebbe più utile `/users/1` o `/users/42`, dove 1 o 42 è l'<mark>id</mark>
                  dell'utente.
                  
                  <pre class="fragment">
                  <code class="javascript" data-noescape>$stateProvider.state('users.detail', {
                    url: <mark>'/:userId'</mark>,
                    controller: 'UserController',
                    controllerAs: '_user',
                    templateUrl: 'user-detail.html'
                  })
                  </code></pre>
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$stateParams`

                  Come utilizziamo il valore di `/:userId` nel controller?

                  <pre class="fragment">
                  <code class="javascript">angular
                    .module('ngUsers')
                    .controller('UserController', ['$stateParams', 'UsersModel', '$scope'], UserController);
                  </code></pre>

                  <pre class="fragment">
                  <code class="javascript">function UserController($stateParams, UsersModel, $scope) {
                    UsersModel
                      .getUserById($stateParams.userId)
                      .then(function(userData) {
                        $scope.userDetail = userData;
                      });
                  }
                  </code></pre>
                    
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Sotto-viste

                  <small>Abbiamo visto che è possibile associare a uno stato più viste, come ad esempio `content` e `sidebar`</small>

                  Ora analizziamo il caso di un layout *molto* complesso:
                  
                  <img class="fragment" data-src="/images/layout-complesso.jpg">

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Stato principale

                  Definiamo lo stato principale

                  ```javascript
                  $stateProvider
                    .state('app', {
                      url: '',        
                      views: {
                        'layout': {
                          templateUrl: 'app/main/main.html',
                          controller: 'MainController',
                          controllerAs: 'main'
                        }
                      }
                    });
                  ```                    
                  </script>
                </section>   

                <section data-markdown>
                  <script type="text/template">
                  Stato principale: la vista

                  
                  ```html
                  <!-- index.html -->
                  <body>
                    <div ui-view="layout"></div>
                  </body>
                  ```

                  ```html
                  <!-- main.html -->
                  <main ui-view="main"></main>
                  <aside ui-view="sidebar"></aside>
                  ```

                  </script>
                </section> 

                <section data-markdown>
                  <script type="text/template">
                  Stato figlio
                  
                  "Dentro" la `ui-view="main"` avremo
                  ```html
                  <!-- Parte comune -->
                  <h1>{{ $users.list }}</h1>
                  <!-- Parte specifica -->
                  <div ui-view="content"></div>
                  ```
                  
                  </script>
                </section>
                                
                <section data-markdown>
                  <script type="text/template">
                  Stato figlio: `app.users`

                  Dovrà occuparsi di 3 viste: main, sidebar e content

                  ```javascript
                  $stateProvider
                    .state('app.users', {
                      url: '/users',        
                      views: {
                        'main@app': {
                          templateUrl: 'app/users/users.html',
                          controller: 'UsersController',
                          controllerAs: '$users'
                        },
                        'sidebar@app': {
                          template: '<p>Sidebar</p>'
                        },
                        'content@app.users': {
                          templateUrl: 'app/users/list/list.html'
                        }
                      }
                    });
                  ```

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Stato figlio: `app.users.detail`

                  Lo stato foglia dovrà sovrascrivere solo la vista content

                  ```javascript
                  $stateProvider
                    .state('app.users.detail', {
                      url: '/:userId',        
                      views: {
                        'content@app.users': {
                          templateUrl: 'app/users/detail/detail.html',
                          controller: 'UserDetailController',
                          controllerAs: '$user'
                        }
                      }
                    });
                    ```

                    [Esempio completo](https://github.com/vincenzomilone/corso-angular-01) <!-- .element class="fragment btn" target="_blank" -->

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Cambi di stato

                  Per passare da uno stato un'altro abbiamo diverse possibilità

                  <div class="fragment">
                  1 - Con un semplice link
                  <pre><code class="html">
                  <a href="/users">Lista utenti</a>
                  <a href="/users/42">Dettaglio utente 42</a>
                  <a ng-href="{{ '/users/'+userId }}">Dettaglio utente {{ userId }}</a>
                  </code></pre>
                  </div>

                  <div class="fragment">
                  2 - Con la direttiva `ui-sref`
                  <pre><code class="html">
                  <a ui-sref="app.users">Lista utenti</a>
                  <a ui-sref="app.users.detail({userId: 42})">Dettaglio utente 42</a>
                  <a ui-sref="app.users.detail({userId: userId})">Dettaglio utente {{ userId }}</a>
                  </code></pre>
                  </div>

                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  3 - Tramite l'oggetto `$state`

                  ```javascript
                  function UsersController($state) {
                    this.goToDetail = function(userId) {
                      $state.go('app.users.detail', {'userId': userId});
                    }
                  }
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `$state` ci fornisce altre utili funzionalità oltre a `.go()`

                  ```javascript
                  // Riferimento allo stato attuale
                  $state.current
                  --> $state.current.name nome stato attuale

                  // includes()
                  $state.includes('app.users')
                  --> return true se siamo in /users e /users/:userId

                  // is()
                  $state.is('app.users')
                  --> return true solo se siamo in /users
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Eventi

                  UI-Router rende disponibili alcuni eventi che vengono sollevati
                  durente le transizioni fra uno stato e un altro.

                  Il più interessante è `$stateChangeStart`, utile per bloccare
                  un cambio di stato.

                  ```javascript
                  $rootScope.$on('$stateChangeStart', 
                  function(event, toState, toParams, fromState, fromParams, options){ 
                      if( !userIsLoggedIn() ) {
                        event.preventDefault();
                        $state.go('app.login');
                      }
                  });
                  ```

                  </script>
                </section>

                <section data-markdown class="small">
                  <script type="text/template">
                  Lista eventi disponibili


                  | Nome evento | Quando viene sollevato |
                  |-------------|------------------------|
                  |`$stateChangeStart`|All'inizio di una transizione di stato|
                  |`$stateChangeSuccess`|Alla fine di una transizione avvenuta con sucesso|
                  |`$stateNotFound`|Lo stato di arrivo non è stato trovato|
                  |`$stateChangeError`|Quando si verifica un errore durante la transizione|
                  |`$viewContentLoading`|All'inizio del *rendering* del DOM di una vista|
                  |`$viewContentLoaded`|Dopo che il DOM di una vista è stato renderizzato|
                  
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  ## Resolve

                  **Caso**: non voglio che lo stato `app.users` sia visibile finché la lista degli utenti non stata scaricata dal server.

                  Ma la chiamata `getUsers()` è asincrona, come faccio ad aspettare che sia conclusa?
                  </script>
                </section>

                 <section data-markdown>
                  <script type="text/template">
                  `resolve` permette di passare al Controller associato il risultato di una *promessa*

                  <small>Si chiama `resolve` perché prima *risolve* la promessa, quindi inizializza il Controller</small>


                  ```javascript
                  $stateParams.state('app.users' {
                    url: '/users',
                    views: {...},
                    resolve: {
                      usersList: ['UsersModel', function(UsersModel) {
                        return UsersModel.getUsers();
                      }]
                    }
                  })
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Quindi nel controller

                  ```javascript
                  function UsersController(usersList) {
                    this.users = usersList;
                  }
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Possiamo risolvere più promesse e mappare i risultati
                  in diversi oggetti
                  
                  ```javascript
                  $stateParams.state('app.users' {
                    url: '/users',
                    views: {...},
                    resolve: {
                      usersList: ['UsersModel', function(UsersModel) {
                        return UsersModel.getUsers();
                      }],
                      currentUser: ['UserModel', function(UserModel) {
                        return UserModel.getCurrentUserDetail();
                      }]
                    }
                  })
                  ```

                  ```javascript
                  function UsersController(usersList, currentUser) {
                    ...
                  }
                  ```
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  `onEnter` e `onExit` sono due funzioni che vengono sollevate quando si *entra* in uno stato e quando si *esce* dallo stato stesso.
                  
                  <small>Queste funzioni hanno accesso a tutti gli oggetti *risolti* da *resolve*</small>

                  ```javascript
                  $stateParams.state('app.users' {
                    url: '/users',
                    views: {...},
                    resolve: {...},
                    onEnter: function(userList, currentUser) {
                      alert(currentUser.firstName+' benvenuto in app.users ');
                    }
                    onExit: function(userList, currentUser) {
                      alert(currentUser.firstName+' stai abbandonando in app.users ');
                    }
                  })
                  ```
                  </script>
                </section>

                <section data-markdown data-background-color="#0084ff">
                  <script type="text/template">
                  # Capitolo V

                  ## Struttura dei sorgenti
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Come mettere insieme moduli, controller, servizi, template, task di gulp ...?

                  Ci sono alcune "buone norme", in parte consigliate dal team di AngularJs e in parte
                  nate dall'esperienza e dalla condivisione sul web.

                  [Struttura](/struttura-sorgenti.html) <!-- .element class="btn fragment" target="blank" -->
                  </script>
                </section>

                <section data-markdown data-background-color="#0084ff">
                  <script type="text/template">
                  # Capitolo VI

                  ## Applicazioni di esempio
                  </script>
                </section>

                <section data-markdown class="small">
                  <script type="text/template">
                  |Applicazione|Scopo|Link|
                  |------------|-----|----|
                  |I applicazione|Mostrare l'uso di UI-Router <small>(già vista in precedenza)</small>|[Link](https://github.com/vincenzomilone/corso-angular-01)
                  |II applicazione|Applicazione che recupera una lista di utenti dal server e la mostra|[Link](/da-fare)
                  |III applicazione|Filtra e ordina utenti. Modifica di un utente|[Link](/da-fare)
                  |IV applicazione|Internalizzazione dell'app|[Link](/da-fare)
                  </script>
                </section>

                <section data-markdown>
                  <script type="text/template">
                  Nuova slide
                  </script>
                </section>
            </div>
        </div>
        <script src="node_modules/headjs/dist/1.0.0/head.min.js"></script>
        <script src="node_modules/reveal.js/js/reveal.js"></script>
        <script>
            Reveal.initialize({
              controls: true,
              progress: true,
              history: true,
              center: true,
              mouseWheel: true,
              dependencies: [
                { src: 'node_modules/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                { src: 'node_modules/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                { src: 'node_modules/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
              ]
            });
        </script>
    </body>
</html>